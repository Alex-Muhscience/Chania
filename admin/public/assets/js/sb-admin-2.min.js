/*!
 * Start Bootstrap - SB Admin 2 v4.1.4 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2021 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */
!function(l){"use strict";l("#sidebarToggle, #sidebarToggleTop").on("click",function(e){l("body").toggleClass("sidebar-toggled"),l(".sidebar").toggleClass("toggled"),l(".sidebar").hasClass("toggled")&&l(".sidebar .collapse").collapse("hide")}),l(window).resize(function(){l(window).width()<768&&l(".sidebar .collapse").collapse("hide"),l(window).width()<480&&!l(".sidebar").hasClass("toggled")&&(l("body").addClass("sidebar-toggled"),l(".sidebar").addClass("toggled"),l(".sidebar .collapse").collapse("hide"))});var e=document.querySelectorAll("#accordionSidebar .collapse");for(var o of e){var i=new bootstrap.Collapse(o,{toggle:!1})}for(var a of document.querySelectorAll("#accordionSidebar .nav-link"))a.addEventListener("click",function(e){var o=this.getAttribute("href");if(o&&"#"!==o&&!o.startsWith("http")){for(var t of document.querySelectorAll("#accordionSidebar .nav-link"))t.classList.remove("active");this.classList.add("active");var n=this.getAttribute("data-bs-target");if(n)for(var r of e)r.hide()}});var t=function(e,o){l(e).length&&new Chart(l(e),{type:"line",data:{labels:o.labels,datasets:[{label:o.label,lineTension:.3,backgroundColor:"rgba(78, 115, 223, 0.05)",borderColor:"rgba(78, 115, 223, 1)",pointRadius:3,pointBackgroundColor:"rgba(78, 115, 223, 1)",pointBorderColor:"rgba(78, 115, 223, 1)",pointHoverRadius:3,pointHoverBackgroundColor:"rgba(78, 115, 223, 1)",pointHoverBorderColor:"rgba(78, 115, 223, 1)",pointHitRadius:10,pointBorderWidth:2,data:o.data}]},options:{maintainAspectRatio:!1,layout:{padding:{left:10,right:25,top:25,bottom:0}},scales:{xAxes:[{time:{unit:"date"},gridLines:{display:!1},ticks:{maxTicksLimit:7}}],yAxes:[{ticks:{maxTicksLimit:5,padding:10,callback:function(e,o,t){return"$"+number_format(e)}},gridLines:{color:"rgb(234, 236, 244)",zeroLineColor:"rgb(234, 236, 244)",drawBorder:!1,borderDash:[2],zeroLineBorderDash:[2]}}]},legend:{display:!1},tooltips:{backgroundColor:"rgb(255,255,255)",bodyFontColor:"#858796",titleMarginBottom:10,titleFontColor:"#6e707e",titleFontSize:14,borderColor:"#dddfeb",borderWidth:1,xPadding:15,yPadding:15,displayColors:!1,intersect:!1,mode:"index",caretPadding:10,callbacks:{label:function(e,o){var t=o.datasets[e.datasetIndex].label||"";return t&&(t+=": "),t+="$"+number_format(e.yLabel)}}}})};function number_format(e,o,t,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var r=isFinite(+e)?+e:0,i=isFinite(+o)?Math.abs(o):0,a=void 0===n?",":n,d=void 0===t?".":t,l="";return l=(i?function(e,o){if(-1<(""+e).indexOf("e")){var t=(""+e).split("e"),n="";return("+"===t[1].substr(0,1)?t[1].substr(1):t[1]),n=parseFloat(t[0]).toFixed(o).split("."),((n[1]?n[0]+"."+n[1]:n[0])+"e"+t[1]).substr(0,o)}var r=e.toString().split(".");return r[0].length>o?parseFloat(e.toPrecision(o)):o?parseFloat(parseFloat(e).toFixed(o)):Math.round(e)}(Math.abs(r),i)+"").split("."),3<l[0].length&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,a)),(l[1]||"").length<i&&(l[1]=l[1]||"",l[1]+=new Array(i-l[1].length+1).join("0")),r<0?"-":"")+(l[0]+(l[1]?d+l[1]:""))}l(".scroll-to-top").click(function(){l("html, body").animate({scrollTop:0},"slow")})}(jQuery);

// Additional custom functionality
(function($) {
    "use strict";

    // Initialize tooltips
    $('[data-bs-toggle="tooltip"]').tooltip();

    // Initialize popovers
    $('[data-bs-toggle="popover"]').popover();

    // Smooth scrolling for anchor links
    $('a.page-scroll').bind('click', function(event) {
        var $anchor = $(this);
        $('html, body').stop().animate({
            scrollTop: ($($anchor.attr('href')).offset().top - 50)
        }, 1250, 'easeInOutExpo');
        event.preventDefault();
    });

    // Auto-hide alerts
    $('.alert[data-auto-dismiss]').each(function() {
        var $alert = $(this);
        var delay = parseInt($alert.data('auto-dismiss')) || 5000;
        setTimeout(function() {
            $alert.fadeOut();
        }, delay);
    });

    // Confirm delete actions
    $(document).on('click', '.btn-delete, .delete-btn', function(e) {
        if (!confirm('Are you sure you want to delete this item? This action cannot be undone.')) {
            e.preventDefault();
            return false;
        }
    });

    // Form validation helper
    $('.needs-validation').each(function() {
        $(this).on('submit', function(e) {
            if (this.checkValidity() === false) {
                e.preventDefault();
                e.stopPropagation();
            }
            $(this).addClass('was-validated');
        });
    });

    // Character counter for textareas
    $('textarea[data-max-length]').each(function() {
        var $textarea = $(this);
        var maxLength = parseInt($textarea.data('max-length'));
        var $counter = $('<small class="text-muted character-counter"></small>');
        
        $textarea.after($counter);
        
        function updateCounter() {
            var currentLength = $textarea.val().length;
            $counter.text(currentLength + ' / ' + maxLength + ' characters');
            
            if (currentLength > maxLength * 0.9) {
                $counter.addClass('text-warning');
            } else {
                $counter.removeClass('text-warning');
            }
            
            if (currentLength >= maxLength) {
                $counter.addClass('text-danger').removeClass('text-warning');
            } else {
                $counter.removeClass('text-danger');
            }
        }
        
        $textarea.on('input keyup', updateCounter);
        updateCounter(); // Initialize
    });

    // File upload preview
    $('input[type="file"][data-preview]').change(function() {
        var file = this.files[0];
        var $preview = $($(this).data('preview'));
        
        if (file && file.type.startsWith('image/')) {
            var reader = new FileReader();
            reader.onload = function(e) {
                $preview.attr('src', e.target.result).show();
            };
            reader.readAsDataURL(file);
        } else {
            $preview.hide();
        }
    });

    // Table row selection
    $('.table-selectable tbody tr').click(function(e) {
        if (e.target.type !== 'checkbox' && !$(e.target).closest('a, button').length) {
            var $checkbox = $(this).find('input[type="checkbox"]');
            $checkbox.prop('checked', !$checkbox.prop('checked')).trigger('change');
        }
    });

    // Bulk actions
    $('.select-all').change(function() {
        var checked = $(this).prop('checked');
        $('.table-selectable tbody input[type="checkbox"]').prop('checked', checked).trigger('change');
    });

    $('.table-selectable tbody input[type="checkbox"]').change(function() {
        var $row = $(this).closest('tr');
        if ($(this).prop('checked')) {
            $row.addClass('table-active');
        } else {
            $row.removeClass('table-active');
        }
        
        // Update bulk action buttons
        var selectedCount = $('.table-selectable tbody input[type="checkbox"]:checked').length;
        $('.bulk-actions').toggle(selectedCount > 0);
        $('.selected-count').text(selectedCount);
    });

})(jQuery);
